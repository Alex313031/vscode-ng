diff --git a/.nvmrc b/.nvmrc
index bc78e9f2695..c85fa1bbef8 100644
--- a/.nvmrc
+++ b/.nvmrc
@@ -1 +1 @@
-20.12.1
+16.17.1
diff --git a/.yarnrc b/.yarnrc
index 31ceae81a48..47d44abde2c 100644
--- a/.yarnrc
+++ b/.yarnrc
@@ -1,5 +1,5 @@
 disturl "https://electronjs.org/headers"
-target "29.3.1"
+target "22.3.27"
 ms_build_id "9464424"
 runtime "electron"
 build_from_source "true"
diff --git a/build/checksums/electron.txt b/build/checksums/electron.txt
index 88fc9eceff0..2d1c9ebeb06 100644
--- a/build/checksums/electron.txt
+++ b/build/checksums/electron.txt
@@ -1,75 +1,75 @@
-e59378f63e935a6a561e272cdf44a8c5c3f4c56a8ff5ed0b33d45f18dd7d0d6c *chromedriver-v29.3.1-darwin-arm64.zip
-4c4b2f11e9a396ff0e4c2282f4afe898f548af5e530a26c4c52fc7dbe307eb31 *chromedriver-v29.3.1-darwin-x64.zip
-10b0d4a01636ae1f064cb950d5cff2a591dff2d2573fa9169335a492815169d3 *chromedriver-v29.3.1-linux-arm64.zip
-45aff39d150dd423536d221bcdf2dab12cef4d0e8df50dddcda0387f60c70843 *chromedriver-v29.3.1-linux-armv7l.zip
-569022d7a6fc4634ee4f496bb0414b7a8b34e505e22c2d423e915776e23d576a *chromedriver-v29.3.1-linux-x64.zip
-d2090eb226eb0fef894837277d08a313af62da5807ab14d4aae7e6ba0a6a8466 *chromedriver-v29.3.1-mas-arm64.zip
-3d425b6713d2a6e3149c4559cff76940e0443e236e61c7ba9b35ce2438f7de15 *chromedriver-v29.3.1-mas-x64.zip
-5a95303fffbab24b07e842441e677ba98966dd800c90a7e842a97e43f7681cd6 *chromedriver-v29.3.1-win32-arm64.zip
-553f8a81b0974c23eb473d5129450413f206e67128f89b7f7723ae76f9e8ec5d *chromedriver-v29.3.1-win32-ia32.zip
-67f2f561703c6008c1c51dfd50be991752dfa3959bf5bb5a3a324143894fdcc5 *chromedriver-v29.3.1-win32-x64.zip
-1e8366964ae298ec1e5e67b3f192c1d7a7cffc1b932b2f32fac3d075962c8f7e *electron-api.json
-80596ef89f4638495bb24a92b75191bb0b61151e3cbc608090c1e406d14cafd5 *electron-v29.3.1-darwin-arm64-dsym-snapshot.zip
-a2804d07dded66a5735aa1d1e5c547ea97bff09e2f1443c019ba564a33a5660b *electron-v29.3.1-darwin-arm64-dsym.zip
-4dd9f6c00f2021dba34532452eecc15ce7e5eb914978319fd03246d19ff66baa *electron-v29.3.1-darwin-arm64-symbols.zip
-aaada7a9f7ee72cd2a9a465ed0b8ec703aeedda9084f67cf72c1dce8e2aff7ca *electron-v29.3.1-darwin-arm64.zip
-cab2c8a7a72c6e6b59e04e3292f27799b4a25592764960d9df4894fab405abc5 *electron-v29.3.1-darwin-x64-dsym-snapshot.zip
-f7706f674d092f314fb30e85985d3172c1a125804e8132b206b65196b8dc81c5 *electron-v29.3.1-darwin-x64-dsym.zip
-f00ec2929503e067b4ee59f8c38d1d2419db5c2af3c2b078d30d17faae8dbd5d *electron-v29.3.1-darwin-x64-symbols.zip
-be6b70648d35959d346924e89aff5419af321c80f929d0e252fba131d9c93f50 *electron-v29.3.1-darwin-x64.zip
-19f8b15ff1eb3a572adab73444c8b12f9815fa8ddaadbd8383ef5bb7370f98cc *electron-v29.3.1-linux-arm64-debug.zip
-db0861e5d285428cc98de1f055fd7ef2fb2b331ebfd3e0a069bdf136b5bdc5c7 *electron-v29.3.1-linux-arm64-symbols.zip
-d900a5597e296cb925dc2e6266b1d839b0254ab12e424d405785d6e351f1c4d7 *electron-v29.3.1-linux-arm64.zip
-19f8b15ff1eb3a572adab73444c8b12f9815fa8ddaadbd8383ef5bb7370f98cc *electron-v29.3.1-linux-armv7l-debug.zip
-8936bb96a59c1ac129555050ae00b478bbc6c16a0e759ed07231624b3ac52749 *electron-v29.3.1-linux-armv7l-symbols.zip
-2a66d5603cf59a28699e4465488032f1dfac6118140ed129cf7403617329f983 *electron-v29.3.1-linux-armv7l.zip
-a1f7984c302b2f7a03e836a7a6026d8ba64ca7806f47cd7b9dcc2e744680fd7c *electron-v29.3.1-linux-x64-debug.zip
-fe2f5a78e7c485423fae7d204f6ba7bea95f9427703e97831a5555ab42ca93f3 *electron-v29.3.1-linux-x64-symbols.zip
-d907e1c8074d2b7933d8b7525da3987f88d5b5ecf88131efec3eb5bd710a15b4 *electron-v29.3.1-linux-x64.zip
-7cd32474a7c024d40ae9f17fe83678ae34b6f631889e895cabed87d0ee1781bf *electron-v29.3.1-mas-arm64-dsym-snapshot.zip
-0058c71c614e252b4ad689de8a492563ebf938ba90cdb124e5454a9ec9d4c75c *electron-v29.3.1-mas-arm64-dsym.zip
-aafedfab99d059079011139cf534bbfca44d50cd0a668b0ca547aeb8eed99c14 *electron-v29.3.1-mas-arm64-symbols.zip
-f45417c845be012f0a9d3b8c92d5d3d5b4b9650e06809a9d783baa1ff8ce75a7 *electron-v29.3.1-mas-arm64.zip
-8a91e7cced48162ec60368a992e8c53ef7e0ba574ce0c6edd8462167ba23b053 *electron-v29.3.1-mas-x64-dsym-snapshot.zip
-4bfdd08bdb98afd3966e6a9c506dbb6e8bbbed7b0b22c7ae019b3cf8564e8354 *electron-v29.3.1-mas-x64-dsym.zip
-dada1302a225509de9e031c8b139096a28398f883c8bdcae4b8fc3a92dc4c99d *electron-v29.3.1-mas-x64-symbols.zip
-555d83c9eea2c1dc40c6996092ef2eb812d9d4937062d53d8909bf2a9432ca88 *electron-v29.3.1-mas-x64.zip
-857bcb8f8866b2183355f71e968a690ec7d9ecc386b507988fe0ab560fe25a57 *electron-v29.3.1-win32-arm64-pdb.zip
-a38ee738e44c3a9470ff765422410c59bd3c0a94a955e3b1ce661b68d094de18 *electron-v29.3.1-win32-arm64-symbols.zip
-c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v29.3.1-win32-arm64-toolchain-profile.zip
-74bcf7b7bb09c6311a5ef01eef41e20eccb84cd169651138234a332ad33aa087 *electron-v29.3.1-win32-arm64.zip
-4650398c9c49b63050b4c2d28ae664c1d14912464a2744170338c131291aa290 *electron-v29.3.1-win32-ia32-pdb.zip
-79a7a2db4c26c231d0963a924b129391cf920cd6b97d28ef095a2a1da4e14577 *electron-v29.3.1-win32-ia32-symbols.zip
-c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v29.3.1-win32-ia32-toolchain-profile.zip
-5527aa7d73b49d1c3298d9f2fc930be775e7d093a70bb613bec73e2ddd316afa *electron-v29.3.1-win32-ia32.zip
-d85bc6393bd5890cf0bc616c41c2a5c0596ea4c3967d51bbf146a12cae727fad *electron-v29.3.1-win32-x64-pdb.zip
-870bc19b8f38a84eb65fa6269fe2026b8dd8b76f9bbeded15c7313923f3e2c66 *electron-v29.3.1-win32-x64-symbols.zip
-c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v29.3.1-win32-x64-toolchain-profile.zip
-ccd465a085578168b6bf88ac76a5946f649e977efa7ef130c460b04df1becffa *electron-v29.3.1-win32-x64.zip
-eab0311367f1e6b264ac788ac7291449d50bddf0049015391370a2eac462c320 *electron.d.ts
-1718c59d8a963ef09325d300e10684d1a2419c186f0c70ac200d03b4142cdbfd *ffmpeg-v29.3.1-darwin-arm64.zip
-a58339efba05ff93ca39e3000ec5aa5c81fb059c8786401324285defad11eb4b *ffmpeg-v29.3.1-darwin-x64.zip
-4e2ba537d7c131abbd34168bce2c28cc9ef6262b217d5f4085afccfdf9635da6 *ffmpeg-v29.3.1-linux-arm64.zip
-4aa56ad5d849f4e61af22678a179346b68aec9100282e1b8a43df25d95721677 *ffmpeg-v29.3.1-linux-armv7l.zip
-0558e6e1f78229d303e16d4d8c290794baa9adc619fdd2ddccadb3ea241a1df4 *ffmpeg-v29.3.1-linux-x64.zip
-a580fce86cd20aaee06ad4136b2dfbbf7a7449be8fc4d1a528535b2a83b067d4 *ffmpeg-v29.3.1-mas-arm64.zip
-41d8a8d20429ea22bbfdd482f1ea2c265cabdca3cacb35737be01f427455204e *ffmpeg-v29.3.1-mas-x64.zip
-ce3bf67555cf614c837d1bc80aaa071627750e3ffcde03a25b750796de23fd43 *ffmpeg-v29.3.1-win32-arm64.zip
-f305313a1c3d15c6308c6158edc2d9cadc7465536adefa57fa31d879e6fe5e55 *ffmpeg-v29.3.1-win32-ia32.zip
-8c6b7febbd80e53ea0cf0e89104006b4211b96d0d05933f517d69d0d578e8726 *ffmpeg-v29.3.1-win32-x64.zip
-59827658661e330bc4ef876419c927a647a9c393aac2e7767887ae0ac600dd65 *hunspell_dictionaries.zip
-1a5ec4216f0f938be6ae45853ffa032cfeb04409f757e9b66228362fe14da74f *libcxx-objects-v29.3.1-linux-arm64.zip
-febbdade1c2958dc24498d62e6402bc1a9add49c3837487cc8ecb0ecb0f28459 *libcxx-objects-v29.3.1-linux-armv7l.zip
-d6c5c7e67f8e50cad64493215b418a303cb5a30e39800c85d28401f66e1addb3 *libcxx-objects-v29.3.1-linux-x64.zip
-57f87572e20185f329334ca9c6971bb7974424fb5ff4aa2e11f3a8668f8060f9 *libcxx_headers.zip
-c7bcb0555dd10aed27ec7041338783df430e58da79ccba6863cbfb8cd89ef062 *libcxxabi_headers.zip
-6962a9872def625e43d87ea4f50e90bc571d5b522abe7b9b33ce17714c43a05e *mksnapshot-v29.3.1-darwin-arm64.zip
-b801394b60eb4cefe52fddd35616be9e79058b53d2860badb1daa0c61242b730 *mksnapshot-v29.3.1-darwin-x64.zip
-906058eaeadb81f918962529185b2cf4b5fc6b13adbbf04fea7fd4ace9c1f20e *mksnapshot-v29.3.1-linux-arm64-x64.zip
-74c9834b9d8237b001cbe5822b2426bebe910a72c1173377c1cd446f726bc2e7 *mksnapshot-v29.3.1-linux-armv7l-x64.zip
-6eafdfcbdc44d48df267ddb09e09e0acda1abbe472211e947ce4b68852f99d52 *mksnapshot-v29.3.1-linux-x64.zip
-04164d534fae6f12ad37e2f2268ec864b3c4417c08134edeeb555dd1bf73c073 *mksnapshot-v29.3.1-mas-arm64.zip
-3a870add5f6c3287f9f958d0327f67d59ef0a9c30bfb94fb7155b6ee6e905e46 *mksnapshot-v29.3.1-mas-x64.zip
-174ac9f2d8b4664587a983067c2b870b6e74fe8079715a502c11d55d774d6317 *mksnapshot-v29.3.1-win32-arm64-x64.zip
-50efe4e272a54d04392ccd8a205164f4c1400c8197648d1a1fa71e667e37d7ff *mksnapshot-v29.3.1-win32-ia32.zip
-e80d3e57ed67f05573a12a65b0be30cdb3e0b147cf817a80eb89b9886e7743ae *mksnapshot-v29.3.1-win32-x64.zip
+e462d1d1f42fbd95f59606138c5f2d127ec7a0194627e613429fd6589f38c778 *chromedriver-v22.3.27-darwin-arm64.zip
+59c89191158c810208dbe6a49015d9232e114330eca514efe362bdf1f9c8c819 *chromedriver-v22.3.27-darwin-x64.zip
+09d1b16ab31a17a914b9a871158458d34c7e5a52c7686ea923b9a9878e6d4539 *chromedriver-v22.3.27-linux-arm64.zip
+f020427cc1972928fd784b4f9ee912e8b42691c782c325fe7624aa2b38a7fcec *chromedriver-v22.3.27-linux-armv7l.zip
+2c0eb7ccc5d68ac52dfcf7264e8dc61de4a9480ededb464c35c0ad7db41b8e53 *chromedriver-v22.3.27-linux-x64.zip
+a6efc976fc8efd469ece8ef7349ba655128496929950beb7b4db4f910ca946fd *chromedriver-v22.3.27-mas-arm64.zip
+5b6dcd7edb370a88037cf858e63e0f03ead9c0089d337d6b5c6eee310dca228f *chromedriver-v22.3.27-mas-x64.zip
+e57141363f51445819436ca9320115931394e9349e6f6bfb2aa8123cb2a2ce21 *chromedriver-v22.3.27-win32-arm64.zip
+56e2a0e427cf889045ef533e350bb9be1c628c95d74b11e6477d654dba459b29 *chromedriver-v22.3.27-win32-ia32.zip
+8d01b742ca0e0f5b6d9eb73a2b650aaf5aeea4e060a6880bdfbf968d710793f7 *chromedriver-v22.3.27-win32-x64.zip
+918f116f80da1fdef14ba3a3a9bb628aac09cb6c3c5fff87cffca9d3c47771ff *electron-api.json
+e0ad02272f26d62ce61535658299217599bf7453631e1272f12b8fc883573b77 *electron-v22.3.27-darwin-arm64-dsym-snapshot.zip
+dbff939cdfec7ce4d9fa16187fb69a357193ebc9ae4082e8da771dd5a5511a23 *electron-v22.3.27-darwin-arm64-dsym.zip
+6c67025cd392fbfd78fbb5676f437eaf62dbc083770899794f43ad10da07a311 *electron-v22.3.27-darwin-arm64-symbols.zip
+2b87e9f766692caaa16d7750bfab2f609c0eab906f55996c7d438d8e18ac8867 *electron-v22.3.27-darwin-arm64.zip
+57120f63f8b6aa91009aa20c76b75d4548b94ab0fdda7d62b835389d0ecc9ae2 *electron-v22.3.27-darwin-x64-dsym-snapshot.zip
+3552ff075bd25128bc6c0fc6a6aafa4db69db7299794aa40187ad87ddb0535b3 *electron-v22.3.27-darwin-x64-dsym.zip
+fef4cc317aeb4d6c790938dba14357932dba488e2116db84570edf0e3d1c5675 *electron-v22.3.27-darwin-x64-symbols.zip
+01f053d08cb2855acb14f0465f4e36324a41bd13b3b2ead142970a56df3e9db1 *electron-v22.3.27-darwin-x64.zip
+3dce7df72fc9aae439e6b93c3abbc8fa32db7685e77ebb143ae9a75a1e06ed82 *electron-v22.3.27-linux-arm64-debug.zip
+57806ef01cdceaecf6a4b7138aa035b91c63cc19b168adb91a45a855d724f6d0 *electron-v22.3.27-linux-arm64-symbols.zip
+60279395a5ce4eaf3c08f1e717771b203830902d3fe3a7c311bc37deb1a0e15e *electron-v22.3.27-linux-arm64.zip
+3dce7df72fc9aae439e6b93c3abbc8fa32db7685e77ebb143ae9a75a1e06ed82 *electron-v22.3.27-linux-armv7l-debug.zip
+136beb93675d0244e74ab51297c2f2cbe956c9ff8dfcdf74337a8e973cbc94f7 *electron-v22.3.27-linux-armv7l-symbols.zip
+9f8372606e5ede83cf1c73a3d8ff07047e4e3ef614aa89a76cd497dc06cf119d *electron-v22.3.27-linux-armv7l.zip
+6ac494b29e67781d55e3b4fbe73ffe2bdf1b422f883f3c265a753bc1547cc24a *electron-v22.3.27-linux-x64-debug.zip
+94b89f034554318d66098a6657d5bacaeb7f03ad98a2f856c8720aed31e75348 *electron-v22.3.27-linux-x64-symbols.zip
+631d8eb08098c48ce2b29421e74c69ac0312b1e42f445d8a805414ba1242bf3a *electron-v22.3.27-linux-x64.zip
+e0ad02272f26d62ce61535658299217599bf7453631e1272f12b8fc883573b77 *electron-v22.3.27-mas-arm64-dsym-snapshot.zip
+b6cf5b125c6be773d3f915a64b13be9e96a4d44a1969c3de74d30cac9c73aafd *electron-v22.3.27-mas-arm64-dsym.zip
+19980e05fc846f45090a3e4571998981a33dccb5766ebfcfd375552bc99066eb *electron-v22.3.27-mas-arm64-symbols.zip
+7757470e871827b15c0b5c64e1734866e9334528689a69b34e64c15a9caada35 *electron-v22.3.27-mas-arm64.zip
+bf8f821d3650bbafa29ff4ea366799d13bda6e21aeab334f961a60a0d662e2b2 *electron-v22.3.27-mas-x64-dsym-snapshot.zip
+e082f5172e1ec429b688606a209eff0a20027b01bb5fac4782bc0b61f2d4d3d9 *electron-v22.3.27-mas-x64-dsym.zip
+f3313c2f9263e19cf9f59d16af86cd672f2581fb894c7b4c849a7cf3a7a989bf *electron-v22.3.27-mas-x64-symbols.zip
+b7c61f0c7c21377630572904ea8a499db9830a3e400672bb23da246c19e6e6a1 *electron-v22.3.27-mas-x64.zip
+3f0caf3642a756aa61c1cedb910fe36c9d0d252df479598940d3c56185da1349 *electron-v22.3.27-win32-arm64-pdb.zip
+a8e5997fcab7774f95301e8687d82538862944c03c50ec75702f32fb053c6b90 *electron-v22.3.27-win32-arm64-symbols.zip
+948e3eee0cf634361eb1afcc0e124d2cf009f9729c4cfac99cddba167f80273b *electron-v22.3.27-win32-arm64-toolchain-profile.zip
+555371d63cae449625c169e9c32b00b1530cdee29bccef8b832f57cebfe8824e *electron-v22.3.27-win32-arm64.zip
+e9693674e527144ad4a4322d2eda8e19dd0042a63dadd51d3029effefe62dec6 *electron-v22.3.27-win32-ia32-pdb.zip
+819b0b9fe7ad888caec215f8e66aa07e3c476638617b969d0e169a973c58a479 *electron-v22.3.27-win32-ia32-symbols.zip
+948e3eee0cf634361eb1afcc0e124d2cf009f9729c4cfac99cddba167f80273b *electron-v22.3.27-win32-ia32-toolchain-profile.zip
+1119ac7112590cb9c10a8c9b0bb5be65c0e11648a4f1311e6b7a5a00e497c2ce *electron-v22.3.27-win32-ia32.zip
+aa6a29c2b4a678ce5ec1e487d85e154d1e58c1c727b1858a24efe2610b7610c5 *electron-v22.3.27-win32-x64-pdb.zip
+8e9c3e42930b1937393b6478c37750f317872786c51f5296de09cec3c8af815e *electron-v22.3.27-win32-x64-symbols.zip
+948e3eee0cf634361eb1afcc0e124d2cf009f9729c4cfac99cddba167f80273b *electron-v22.3.27-win32-x64-toolchain-profile.zip
+ad723ed7dad32f9459f7a9de1fd6d718cf713c4809c2431503bea62ce8f786e6 *electron-v22.3.27-win32-x64.zip
+f7dd34e0b335a1980d6aebc62d4d1383a051d6a1f895052f73a3ff8f9dd03cce *electron.d.ts
+cc5f6b70a3d57e34492ee85a11346ed3a1aaf3b4f9f17c2594afe4048414e654 *ffmpeg-v22.3.27-darwin-arm64.zip
+ff4586bd27b1a0a4d19f9da9d1a77b30ff6afb6a9a868a3d4c9844b7d4aa8ae1 *ffmpeg-v22.3.27-darwin-x64.zip
+59d2e2b2f2cc515a86a4e0cfd1116d10a8b25a8d58d45bb04de3512e156c944b *ffmpeg-v22.3.27-linux-arm64.zip
+b9d3b227bee17666d395ee7882ef477a733c3eeef3f1d9f2e3616d2d02eb3376 *ffmpeg-v22.3.27-linux-armv7l.zip
+fa07ef910b23a4ef4b6761bc16d20c0e70ff0259325c4d523129e2d9c5084174 *ffmpeg-v22.3.27-linux-x64.zip
+5ecdc59a23417cc59ddb5a943cc2aa4fcad5da7c115d070fb697135662d1922e *ffmpeg-v22.3.27-mas-arm64.zip
+faee7693f94b51094210d2fb3355deb16fd1b15d4c04d4e51ab8f77633a50f58 *ffmpeg-v22.3.27-mas-x64.zip
+ab34f1ff4a781e71f6c268b5198e893ed4f6bd6962639eaa01779292e89bad0b *ffmpeg-v22.3.27-win32-arm64.zip
+b14e3730694de4763061d83bc3006e68c2b235de0bf087a64aedc10182eb8b79 *ffmpeg-v22.3.27-win32-ia32.zip
+9c503e5a180c756094c1bcba1d1f71f18eeb1f58ed00d7ed53a8442befce3f71 *ffmpeg-v22.3.27-win32-x64.zip
+d2869fbeb76c750dfdc7ab3cc18379ac7da596d3b67f96f7b37153410420a17b *hunspell_dictionaries.zip
+f5959546231f39e70fde4c10a21ec9cb6bf21792ce48260450a2fe8d79078f90 *libcxx-objects-v22.3.27-linux-arm64.zip
+64aede20ce330331b11021ac2a5bfb664cf85582d2d94a5fab83945ebd074720 *libcxx-objects-v22.3.27-linux-armv7l.zip
+25dcaf59ca47ed6ce9828b8134980f7ab7719623407aee6549335314b555d84c *libcxx-objects-v22.3.27-linux-x64.zip
+c38f100d27955a60e563aa0ffc5e03edbd37ad70ef5294e4021fd9971af262e7 *libcxx_headers.zip
+aa703a89c36fc6c3970e491321b09aa9c22387da7fc24e033cd6ff4f1bd69fb3 *libcxxabi_headers.zip
+160987240aafcf545ee73feeeda31cf9b9d59084a5268f2d8a83cf83703a7b72 *mksnapshot-v22.3.27-darwin-arm64.zip
+ed46ab6112a3e4aaf12b223e1761896fcfa44ccf13a4d01445b71272dcb22b21 *mksnapshot-v22.3.27-darwin-x64.zip
+3a0e5ef31b91d2b7beb28ebc87e2ab5bd1abc8a3ab1902a147322c8824601ab2 *mksnapshot-v22.3.27-linux-arm64-x64.zip
+2614d68292d6267e8d7d2a598c605938d48c84ce895607137599ae4841086e41 *mksnapshot-v22.3.27-linux-armv7l-x64.zip
+cf128df524c9c5e6916f41dcc49d094834cdad7d7cbb050deee9d55645a3bcab *mksnapshot-v22.3.27-linux-x64.zip
+0b02cab2889af3576c60f3b1912717827811c0084c54d636ee3f8bc33417e53d *mksnapshot-v22.3.27-mas-arm64.zip
+a9cffdd62850d4b62793556ed1aaa13664a75a26837543a364400e4fcd5ee4ea *mksnapshot-v22.3.27-mas-x64.zip
+3d69cf2b841f79892141ca5d5335e156bc2fda4208c172406a247786089fe4d1 *mksnapshot-v22.3.27-win32-arm64-x64.zip
+6323cffb19bbd7b8ba99080e1299f91f75ed96e4ffbe226a7dc5000a0db8bc3c *mksnapshot-v22.3.27-win32-ia32.zip
+e61ed6727564ff5155c0c6df5394092c16f55c84542b55de6381d7b77fb638db *mksnapshot-v22.3.27-win32-x64.zip
\ No newline at end of file
diff --git a/build/checksums/nodejs.txt b/build/checksums/nodejs.txt
index 63d24a93ab6..edc1af90cd9 100644
--- a/build/checksums/nodejs.txt
+++ b/build/checksums/nodejs.txt
@@ -1,7 +1,34 @@
-31d2d46ae8d8a3982f54e2ff1e60c2e4a8e80bf78a3e8b46dcaac95ac5d7ce6a  node-v20.9.0-darwin-arm64.tar.gz
-fc5b73f2a78c17bbe926cdb1447d652f9f094c79582f1be6471b4b38a2e1ccc8  node-v20.9.0-darwin-x64.tar.gz
-d2a7dbeeb274bfd16b579d2cafb92f673010df36c83a5b55de3916aad6806a6a  node-v20.9.0-linux-arm64.tar.gz
-a28a0de05177106d241ef426b3e006022bc7d242224adace7565868bd9ee6c06  node-v20.9.0-linux-armv7l.tar.gz
-f0919f092fbf74544438907fa083c21e76b2d7a4bc287f0607ada1553ef16f60  node-v20.9.0-linux-x64.tar.gz
-54e165b89e75158993910053db5b0e652c1826521e624126de5ca6de9ff7b06d  win-arm64/node.exe
-538140015da83597ea7e7ef5e108ebac8a2dc4784b2a4134222b6c27c39f90ad  win-x64/node.exe
+dfb37570ef34ac04f34c26d0ec558df60a9665df5961c01c1657c0ca495f2f01  node-v16.17.1-aix-ppc64.tar.gz
+f9f02f7872e2e8ee54320fce13deb9d56904f32bb0615b6e21aa3371d8899150  node-v16.17.1-darwin-arm64.tar.gz
+09a45f60bfb9dfbea4f69044dc733ef983945acd92ca89ccccac267f3d71bd44  node-v16.17.1-darwin-arm64.tar.xz
+3db26761ad8493b894d42260d7e65094b7af9bc473588739e61bc1c32d6ff955  node-v16.17.1-darwin-x64.tar.gz
+8e7089956fa01cf7d0045945c0863d282dc6818fb0476237c1396497e29a4254  node-v16.17.1-darwin-x64.tar.xz
+35ccb95caf02cda3bd680da4350a8ae5d666a7a9eae3afe5c2a1b3ef29aef108  node-v16.17.1-headers.tar.gz
+554c8d1b4b16e0f4c073b9df7c49c893716a3a533f25ac646f23619f5ccee7df  node-v16.17.1-headers.tar.xz
+adc7032888d4e672a4aac886baede8c04fccdd1a2e7ab4bcf325e3f336f44a3d  node-v16.17.1-linux-arm64.tar.gz
+3dfb8fd8f6b97df69cdc56524abc906c50ef1d0bf091188616802e6c7c731389  node-v16.17.1-linux-arm64.tar.xz
+aeab05e35f1d2824ecfb88ca321f1408b44d292b2775f2890972c828e00216d0  node-v16.17.1-linux-armv7l.tar.gz
+a035ceefb5e16f5fce98c8ddfdf721b96eec20542c72fb8781bcbb6ef20c5550  node-v16.17.1-linux-armv7l.tar.xz
+1f48de7bed99e973c4c50f1b7fc99fc9af5144d093fd6d2b50a1e43b5818bf05  node-v16.17.1-linux-ppc64le.tar.gz
+70305934661f89fca64053b85317a75f233d5e3fdb2caa6546a19262a519cf20  node-v16.17.1-linux-ppc64le.tar.xz
+029dad48018bda07b481213816549b632059fc673c30fdc7a353e04619128344  node-v16.17.1-linux-s390x.tar.gz
+1a47f604944c6aff37cb7483503155671cdb34bda9bfb8962007bc440fa04d77  node-v16.17.1-linux-s390x.tar.xz
+da5658693243b3ecf6a4cba6751a71df1eb9e9703ca93b42a9404aed85f58ad0  node-v16.17.1-linux-x64.tar.gz
+06ba2eb34aa385967f5f58c87a44753f83212f6cccea892b33f80a2e7fda8384  node-v16.17.1-linux-x64.tar.xz
+12d10476ea7483298364c810c037b9316d1a73dc8c81cfeff7d794aecadde498  node-v16.17.1.pkg
+e423985f6019b2026f9a191adb56a96ae83ecd56cdf839cf94aa980168b7a90f  node-v16.17.1.tar.gz
+6721feb4152d56d2c6b358ce397abd5a7f1daf09ee2e25c5021b9b4d3f86a330  node-v16.17.1.tar.xz
+9777e8c4b2864c5b54a0e4e9400f14887db68560a09b94b4113b560a64d1e680  node-v16.17.1-win-x64.7z
+ed290151efb417262b9808a70738d4ab79e9d53653a6a9f4b8dd97912e279dce  node-v16.17.1-win-x64.zip
+0f8101648d5c9e49e89fee541da9e574f899716c32b7c51a732b1766b9fc4526  node-v16.17.1-win-x86.7z
+189b5e8b23226403e7b07a46614de19b444d369e694901e3668e2f549799cbcd  node-v16.17.1-win-x86.zip
+1bdff65fb7642425c0d6826084d63c4be43520316f0ea0b46e6a51999a0ed7fc  node-v16.17.1-x64.msi
+b737eb23a2c67c253b9364b5284123faf5220d567615bebd4ec4b81070e4d177  node-v16.17.1-x86.msi
+f518a70dcab7c3fac5b2e1ef100b4f628edfb160f4fafa9a94ef222da8a6e9ab  win-x64/node.exe
+2f459a64647db493da63c790ce368ad54f59f086d9f22f59c5018680420197b3  win-x64/node.lib
+23215ce7d1e9de9777c3407239e7cf18d29d60f757b772219421ab361ac67c74  win-x64/node_pdb.7z
+8e32ec12028fd3e3147435be79a858ed9c870aaafa1fcb291362307ef3c47547  win-x64/node_pdb.zip
+2393aff88be19dbe0205cbde4ff0c1d89911b15de5c99c80f6e5e29604eecd12  win-x86/node.exe
+5018c3d42f3fbacbd06cb943b3f2696c8e67ca9bdf6864d0e263d6d6911dffd2  win-x86/node.lib
+05a4db56444a60ee70b0d2642d7f2d82a33339894d2d73bd07b1a41d6c869e04  win-x86/node_pdb.7z
+8f86eacb7f13a1bf6738cb0819d7854a2abca40fc2e9e1f91421e44ba52cad7e  win-x86/node_pdb.zip
diff --git a/build/lib/builtInExtensionsCG.js b/build/lib/builtInExtensionsCG.js
index 30b6791b3a0..df22f2d5301 100644
--- a/build/lib/builtInExtensionsCG.js
+++ b/build/lib/builtInExtensionsCG.js
@@ -4,6 +4,7 @@
  *  Licensed under the MIT License. See License.txt in the project root for license information.
  *--------------------------------------------------------------------------------------------*/
 Object.defineProperty(exports, "__esModule", { value: true });
+const node_fetch_1 = require("node-fetch");
 const fs = require("fs");
 const path = require("path");
 const url = require("url");
@@ -22,9 +23,9 @@ async function downloadExtensionDetails(extension) {
     const repositoryContentBaseUrl = `https://${token ? `${token}@` : ''}${contentBasePath}/${repository}/v${extension.version}`;
     async function getContent(fileName) {
         try {
-            const response = await fetch(`${repositoryContentBaseUrl}/${fileName}`);
+            const response = await (0, node_fetch_1.default)(`${repositoryContentBaseUrl}/${fileName}`);
             if (response.ok) {
-                return { fileName, body: Buffer.from(await response.arrayBuffer()) };
+                return { fileName, body: await response.buffer() };
             }
             else if (response.status === 404) {
                 return { fileName, body: undefined };
@@ -76,4 +77,4 @@ main().then(() => {
     console.error(err);
     process.exit(1);
 });
-//# sourceMappingURL=builtInExtensionsCG.js.map
\ No newline at end of file
+//# sourceMappingURL=builtInExtensionsCG.js.map
diff --git a/build/lib/builtInExtensionsCG.ts b/build/lib/builtInExtensionsCG.ts
index 62d09498221..a84f4312b99 100644
--- a/build/lib/builtInExtensionsCG.ts
+++ b/build/lib/builtInExtensionsCG.ts
@@ -3,6 +3,7 @@
  *  Licensed under the MIT License. See License.txt in the project root for license information.
  *--------------------------------------------------------------------------------------------*/
 
+import fetch from 'node-fetch';
 import * as fs from 'fs';
 import * as path from 'path';
 import * as url from 'url';
@@ -29,7 +30,7 @@ async function downloadExtensionDetails(extension: IExtensionDefinition): Promis
 		try {
 			const response = await fetch(`${repositoryContentBaseUrl}/${fileName}`);
 			if (response.ok) {
-				return { fileName, body: Buffer.from(await response.arrayBuffer()) };
+				return { fileName, body: await response.buffer() };
 			} else if (response.status === 404) {
 				return { fileName, body: undefined };
 			} else {
diff --git a/build/lib/compilation.ts b/build/lib/compilation.ts
index b88d0d29003..cf7fbdad943 100644
--- a/build/lib/compilation.ts
+++ b/build/lib/compilation.ts
@@ -226,7 +226,7 @@ class MonacoGenerator {
 		}
 	}
 
-	private _executeSoonTimer: NodeJS.Timeout | null = null;
+	private _executeSoonTimer: NodeJS.Timer | null = null;
 	private _executeSoon(): void {
 		if (this._executeSoonTimer !== null) {
 			clearTimeout(this._executeSoonTimer);
diff --git a/build/lib/fetch.js b/build/lib/fetch.js
index 2fed63bca0e..88491b68827 100644
--- a/build/lib/fetch.js
+++ b/build/lib/fetch.js
@@ -8,6 +8,7 @@ exports.fetchUrls = fetchUrls;
 exports.fetchUrl = fetchUrl;
 exports.fetchGithub = fetchGithub;
 const es = require("event-stream");
+const node_fetch_1 = require("node-fetch");
 const VinylFile = require("vinyl");
 const log = require("fancy-log");
 const ansiColors = require("ansi-colors");
@@ -43,7 +44,7 @@ async function fetchUrl(url, options, retries = 10, retryDelay = 1000) {
         const controller = new AbortController();
         const timeout = setTimeout(() => controller.abort(), 30 * 1000);
         try {
-            const response = await fetch(url, {
+            const response = await (0, node_fetch_1.default)(url, {
                 ...options.nodeFetchOptions,
                 signal: controller.signal /* Typings issue with lib.dom.d.ts */
             });
@@ -51,7 +52,7 @@ async function fetchUrl(url, options, retries = 10, retryDelay = 1000) {
                 log(`Fetch completed: Status ${response.status}. Took ${ansiColors.magenta(`${new Date().getTime() - startTime} ms`)}`);
             }
             if (response.ok && (response.status >= 200 && response.status < 300)) {
-                const contents = Buffer.from(await response.arrayBuffer());
+                const contents = await response.buffer();
                 if (options.checksumSha256) {
                     const actualSHA256Checksum = crypto.createHash('sha256').update(contents).digest('hex');
                     if (actualSHA256Checksum !== options.checksumSha256) {
@@ -135,4 +136,4 @@ function fetchGithub(repo, options) {
         }
     }));
 }
-//# sourceMappingURL=fetch.js.map
\ No newline at end of file
+//# sourceMappingURL=fetch.js.map
diff --git a/build/lib/fetch.ts b/build/lib/fetch.ts
index dc1de777e04..ac9ac7ceb2e 100644
--- a/build/lib/fetch.ts
+++ b/build/lib/fetch.ts
@@ -4,6 +4,7 @@
  *--------------------------------------------------------------------------------------------*/
 
 import * as es from 'event-stream';
+import fetch, { RequestInit } from 'node-fetch';
 import * as VinylFile from 'vinyl';
 import * as log from 'fancy-log';
 import * as ansiColors from 'ansi-colors';
@@ -60,7 +61,7 @@ export async function fetchUrl(url: string, options: IFetchOptions, retries = 10
 				log(`Fetch completed: Status ${response.status}. Took ${ansiColors.magenta(`${new Date().getTime() - startTime} ms`)}`);
 			}
 			if (response.ok && (response.status >= 200 && response.status < 300)) {
-				const contents = Buffer.from(await response.arrayBuffer());
+				const contents = await response.buffer();
 				if (options.checksumSha256) {
 					const actualSHA256Checksum = crypto.createHash('sha256').update(contents).digest('hex');
 					if (actualSHA256Checksum !== options.checksumSha256) {
diff --git a/build/lib/policies.js b/build/lib/policies.js
index 466295b8ad5..2b9d8afaf77 100644
--- a/build/lib/policies.js
+++ b/build/lib/policies.js
@@ -10,6 +10,7 @@ const path = require("path");
 const byline = require("byline");
 const ripgrep_1 = require("@vscode/ripgrep");
 const Parser = require("tree-sitter");
+const node_fetch_1 = require("node-fetch");
 const { typescript } = require('tree-sitter-typescript');
 const product = require('../../product.json');
 const packageJson = require('../../package.json');
@@ -425,7 +426,7 @@ async function getSpecificNLS(resourceUrlTemplate, languageId, version) {
         path: 'extension/translations/main.i18n.json'
     };
     const url = resourceUrlTemplate.replace(/\{([^}]+)\}/g, (_, key) => resource[key]);
-    const res = await fetch(url);
+    const res = await (0, node_fetch_1.default)(url);
     if (res.status !== 200) {
         throw new Error(`[${res.status}] Error downloading language pack ${languageId}@${version}`);
     }
@@ -446,7 +447,7 @@ function compareVersions(a, b) {
     return a[2] - b[2];
 }
 async function queryVersions(serviceUrl, languageId) {
-    const res = await fetch(`${serviceUrl}/extensionquery`, {
+    const res = await (0, node_fetch_1.default)(`${serviceUrl}/extensionquery`, {
         method: 'POST',
         headers: {
             'Accept': 'application/json;api-version=3.0-preview.1',
@@ -523,4 +524,4 @@ if (require.main === module) {
         process.exit(1);
     });
 }
-//# sourceMappingURL=policies.js.map
\ No newline at end of file
+//# sourceMappingURL=policies.js.map
diff --git a/build/lib/policies.ts b/build/lib/policies.ts
index 68f6989f27a..0e89508fe8e 100644
--- a/build/lib/policies.ts
+++ b/build/lib/policies.ts
@@ -9,6 +9,7 @@ import * as path from 'path';
 import * as byline from 'byline';
 import { rgPath } from '@vscode/ripgrep';
 import * as Parser from 'tree-sitter';
+import fetch from 'node-fetch';
 const { typescript } = require('tree-sitter-typescript');
 const product = require('../../product.json');
 const packageJson = require('../../package.json');
diff --git a/build/linux/debian/calculate-deps.js b/build/linux/debian/calculate-deps.js
index bbcb6bfc3de..ff88c2512bc 100644
--- a/build/linux/debian/calculate-deps.js
+++ b/build/linux/debian/calculate-deps.js
@@ -78,9 +78,12 @@ function calculatePackageDeps(binaryPath, arch, chromiumSysroot, vscodeSysroot)
     // TODO(deepak1556): remove this workaround in favor of computing the
     // versions from build container for native modules.
     const filteredDeps = depsStr.split(', ').filter(dependency => {
-        return !dependency.startsWith('libgcc-s1');
+        return !dependency.startsWith('libgcc-s1') &&
+            !dependency.startsWith('libgssapi-krb5-2') &&
+            !dependency.startsWith('libkrb5-3') &&
+            !dependency.startsWith('libxkbfile1');
     }).sort();
     const requires = new Set(filteredDeps);
     return requires;
 }
-//# sourceMappingURL=calculate-deps.js.map
\ No newline at end of file
+//# sourceMappingURL=calculate-deps.js.map
diff --git a/build/linux/debian/calculate-deps.ts b/build/linux/debian/calculate-deps.ts
index 92f8065f262..f964ccfbf41 100644
--- a/build/linux/debian/calculate-deps.ts
+++ b/build/linux/debian/calculate-deps.ts
@@ -90,7 +90,10 @@ function calculatePackageDeps(binaryPath: string, arch: DebianArchString, chromi
 	// TODO(deepak1556): remove this workaround in favor of computing the
 	// versions from build container for native modules.
 	const filteredDeps = depsStr.split(', ').filter(dependency => {
-		return !dependency.startsWith('libgcc-s1');
+        return !dependency.startsWith('libgcc-s1') &&
+            !dependency.startsWith('libgssapi-krb5-2') &&
+            !dependency.startsWith('libkrb5-3') &&
+            !dependency.startsWith('libxkbfile1');
 	}).sort();
 	const requires = new Set(filteredDeps);
 	return requires;
diff --git a/build/npm/preinstall.js b/build/npm/preinstall.js
index fdb01f579d6..e98ed70625b 100644
--- a/build/npm/preinstall.js
+++ b/build/npm/preinstall.js
@@ -10,8 +10,8 @@ const minorNodeVersion = parseInt(nodeVersion[2]);
 const patchNodeVersion = parseInt(nodeVersion[3]);
 
 if (!process.env['VSCODE_SKIP_NODE_VERSION_CHECK']) {
-	if (majorNodeVersion < 20) {
-		console.error('\x1b[1;31m*** Please use latest Node.js v20 LTS for development.\x1b[0;0m');
+	if (majorNodeVersion < 16) {
+		console.error('\x1b[1;31m*** Please use latest Node.js v16 LTS for development.\x1b[0;0m');
 		err = true;
 	}
 }
diff --git a/build/package.json b/build/package.json
index 2b89bbc1c99..a207051e37c 100644
--- a/build/package.json
+++ b/build/package.json
@@ -4,7 +4,7 @@
   "license": "MIT",
   "devDependencies": {
     "@azure/cosmos": "^3",
-    "@azure/identity": "^3.4.1",
+    "@azure/identity": "3.3.2",
     "@azure/storage-blob": "^12.17.0",
     "@electron/get": "^2.0.0",
     "@types/ansi-colors": "^3.2.0",
@@ -48,6 +48,7 @@
     "jsonc-parser": "^2.3.0",
     "mime": "^1.4.1",
     "mkdirp": "^1.0.4",
+    "node-fetch": "2.7.0",
     "source-map": "0.6.1",
     "ternary-stream": "^3.0.0",
     "through2": "^4.0.2",
@@ -56,6 +57,14 @@
     "workerpool": "^6.4.0",
     "yauzl": "^2.10.0"
   },
+  "resolutions": {
+    "@azure/core-auth": "1.5.0",
+    "@azure/core-client": "1.7.3",
+    "@azure/core-lro": "2.5.4",
+    "@azure/core-rest-pipeline": "1.12.2",
+    "@azure/core-tracing": "1.0.1",
+    "@azure/core-util": "1.6.1"
+  },
   "scripts": {
     "compile": "../node_modules/.bin/tsc -p tsconfig.build.json",
     "watch": "../node_modules/.bin/tsc -p tsconfig.build.json --watch",
diff --git a/build/win32/code.iss b/build/win32/code.iss
index fca3d1e9d9b..84293ea37b8 100644
--- a/build/win32/code.iss
+++ b/build/win32/code.iss
@@ -26,7 +26,7 @@ SetupIconFile={#RepoDir}\resources\win32\code.ico
 UninstallDisplayIcon={app}\{#ExeBasename}.exe
 ChangesEnvironment=true
 ChangesAssociations=true
-MinVersion=10.0
+MinVersion=6.0
 SourceDir={#SourceDir}
 AppVersion={#Version}
 VersionInfoVersion={#RawVersion}
diff --git a/cgmanifest.json b/cgmanifest.json
index a85c770cff2..f08c5299976 100644
--- a/cgmanifest.json
+++ b/cgmanifest.json
@@ -6,7 +6,7 @@
 				"git": {
 					"name": "chromium",
 					"repositoryUrl": "https://chromium.googlesource.com/chromium/src",
-					"commitHash": "f1a45d7ded05d64ca8136cc142ddc0c271b1dd43"
+					"commitHash": "513ac8b2c47c7e1ac6b9f4fb5ea98e965cf29b66"
 				}
 			},
 			"licenseDetail": [
@@ -40,7 +40,7 @@
 				"SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE."
 			],
 			"isOnlyProductionDependency": true,
-			"version": "122.0.6261.156"
+			"version": "108.0.5359.215"
 		},
 		{
 			"component": {
@@ -48,7 +48,7 @@
 				"git": {
 					"name": "ffmpeg",
 					"repositoryUrl": "https://chromium.googlesource.com/chromium/third_party/ffmpeg",
-					"commitHash": "17525de887d54b970ffdd421a0879c1db1952307"
+					"commitHash": "b9f01c3c54576330b2cf8918c54d5ee5be8faefe"
 				}
 			},
 			"isOnlyProductionDependency": true,
@@ -516,11 +516,11 @@
 				"git": {
 					"name": "nodejs",
 					"repositoryUrl": "https://github.com/nodejs/node",
-					"commitHash": "22f383dcd529d6bf790856db614a35fea78e825f"
+					"commitHash": "6b06e89c7dfccec6792008302af1cee57649445c"
 				}
 			},
 			"isOnlyProductionDependency": true,
-			"version": "20.9.0"
+			"version": "16.17.1"
 		},
 		{
 			"component": {
@@ -528,12 +528,12 @@
 				"git": {
 					"name": "electron",
 					"repositoryUrl": "https://github.com/electron/electron",
-					"commitHash": "384642792eb521b978a008ee1dbc30885edb7dcb"
+					"commitHash": "e2dac668c680a8b58f204ce14ad88431a2db4339"
 				}
 			},
 			"isOnlyProductionDependency": true,
 			"license": "MIT",
-			"version": "29.3.1"
+			"version": "22.3.27"
 		},
 		{
 			"component": {
diff --git a/package.json b/package.json
index 6b0467b4a14..148b23f69e5 100644
--- a/package.json
+++ b/package.json
@@ -117,9 +117,9 @@
     "@types/kerberos": "^1.1.2",
     "@types/minimist": "^1.2.1",
     "@types/mocha": "^9.1.1",
-    "@types/node": "20.x",
-    "@types/sinon": "^10.0.2",
-    "@types/sinon-test": "^2.4.2",
+    "@types/node": "16.x",
+    "@types/sinon": "10.0.16",
+    "@types/sinon-test": "2.4.6",
     "@types/trusted-types": "^1.0.6",
     "@types/vscode-notebook-renderer": "^1.72.0",
     "@types/webpack": "^5.28.5",
@@ -131,7 +131,7 @@
     "@typescript-eslint/eslint-plugin": "^6.21.0",
     "@typescript-eslint/experimental-utils": "^5.57.0",
     "@typescript-eslint/parser": "^6.21.0",
-    "@vscode/gulp-electron": "^1.36.0",
+    "@vscode/gulp-electron": "git+https://github.com/Alex313031/vscode-gulp-electron.git",
     "@vscode/l10n-dev": "0.0.35",
     "@vscode/telemetry-extractor": "^1.10.2",
     "@vscode/test-cli": "^0.0.6",
@@ -148,7 +148,7 @@
     "cssnano": "^6.0.3",
     "debounce": "^1.0.0",
     "deemon": "^1.8.0",
-    "electron": "29.3.1",
+    "electron": "22.3.27",
     "eslint": "8.36.0",
     "eslint-plugin-header": "3.1.1",
     "eslint-plugin-jsdoc": "^46.5.0",
@@ -197,10 +197,10 @@
     "postcss": "^8.4.33",
     "postcss-nesting": "^12.0.2",
     "pump": "^1.0.1",
-    "rcedit": "^1.1.0",
+    "rcedit": "^1.1.2",
     "rimraf": "^2.2.8",
-    "sinon": "^12.0.1",
-    "sinon-test": "^3.1.3",
+    "sinon": "12.0.1",
+    "sinon-test": "3.1.5",
     "source-map": "0.6.1",
     "source-map-support": "^0.3.2",
     "style-loader": "^3.3.2",
@@ -217,6 +217,14 @@
     "yaserver": "^0.4.0"
   },
   "resolutions": {
+    "@azure/core-auth": "1.5.0",
+    "@azure/core-client": "1.7.3",
+    "@azure/core-lro": "2.5.4",
+    "@azure/core-rest-pipeline": "1.12.2",
+    "@azure/core-tracing": "1.0.1",
+    "@azure/core-util": "1.6.1",
+    "@azure-rest/core-client": "1.1.4",
+    "@types/sinon": "10.0.16",
     "node-gyp-build": "4.8.1"
   },
   "repository": {
diff --git a/remote/.yarnrc b/remote/.yarnrc
index 60d35d09192..c7dcce182ae 100644
--- a/remote/.yarnrc
+++ b/remote/.yarnrc
@@ -1,5 +1,5 @@
 disturl "https://nodejs.org/dist"
-target "20.9.0"
+target "16.17.1"
 ms_build_id "267516"
 runtime "node"
 build_from_source "true"
diff --git a/src/vs/base/parts/sandbox/common/electronTypes.ts b/src/vs/base/parts/sandbox/common/electronTypes.ts
index f8c7a35e077..d54657e0147 100644
--- a/src/vs/base/parts/sandbox/common/electronTypes.ts
+++ b/src/vs/base/parts/sandbox/common/electronTypes.ts
@@ -21,7 +21,7 @@ export interface MessageBoxOptions {
 	 * displays the same icon as `info`, unless you set an icon using the `icon`
 	 * option. On macOS, both `warning` and `error` display the same warning icon.
 	 */
-	type?: ('none' | 'info' | 'error' | 'question' | 'warning');
+	type?: string;
 	/**
 	 * Array of texts for buttons. On Windows, an empty array will result in one button
 	 * labeled "OK".
diff --git a/src/vs/code/electron-sandbox/processExplorer/media/processExplorer.css b/src/vs/code/electron-sandbox/processExplorer/media/processExplorer.css
index 3baf48ce1af..2216a7f7f0a 100644
--- a/src/vs/code/electron-sandbox/processExplorer/media/processExplorer.css
+++ b/src/vs/code/electron-sandbox/processExplorer/media/processExplorer.css
@@ -42,7 +42,8 @@ body {
 }
 
 .pid {
-	width: 50px
+	width: 50px;
+	margin-right: 4px;
 }
 
 .memory {
diff --git a/src/vs/platform/windows/electron-main/windowImpl.ts b/src/vs/platform/windows/electron-main/windowImpl.ts
index dcb3a1776ec..dc2074d82f9 100644
--- a/src/vs/platform/windows/electron-main/windowImpl.ts
+++ b/src/vs/platform/windows/electron-main/windowImpl.ts
@@ -378,11 +378,7 @@ export abstract class BaseWindow extends Disposable implements IBaseWindow {
 		// macOS: traffic lights
 		else if (isMacintosh && options.height !== undefined) {
 			const verticalOffset = (options.height - 15) / 2; // 15px is the height of the traffic lights
-			if (!verticalOffset) {
-				win.setWindowButtonPosition(null);
-			} else {
-				win.setWindowButtonPosition({ x: verticalOffset, y: verticalOffset });
-			}
+			win.setTrafficLightPosition({ x: verticalOffset, y: verticalOffset });
 		}
 	}
 
diff --git a/src/vs/server/node/remoteExtensionHostAgentServer.ts b/src/vs/server/node/remoteExtensionHostAgentServer.ts
index 9eace08d06a..ed4898dd373 100644
--- a/src/vs/server/node/remoteExtensionHostAgentServer.ts
+++ b/src/vs/server/node/remoteExtensionHostAgentServer.ts
@@ -551,8 +551,7 @@ class RemoteExtensionHostAgentServer extends Disposable implements IServerAPI {
 			const socket = net.createConnection(
 				{
 					host: host,
-					port: port,
-					autoSelectFamily: true
+					port: port
 				}, () => {
 					socket.removeListener('error', e);
 					socket.pause();
diff --git a/src/vs/workbench/electron-sandbox/actions/windowActions.ts b/src/vs/workbench/electron-sandbox/actions/windowActions.ts
index 5693f076eec..c1d97f330d0 100644
--- a/src/vs/workbench/electron-sandbox/actions/windowActions.ts
+++ b/src/vs/workbench/electron-sandbox/actions/windowActions.ts
@@ -43,9 +43,9 @@ export class CloseWindowAction extends Action2 {
 			f1: true,
 			keybinding: {
 				weight: KeybindingWeight.WorkbenchContrib,
-				mac: { primary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyW },
-				linux: { primary: KeyMod.Alt | KeyCode.F4, secondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyW] },
-				win: { primary: KeyMod.Alt | KeyCode.F4, secondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyW] }
+				mac: { primary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyQ },
+				linux: { primary: KeyMod.Alt | KeyCode.F4, secondary: [KeyMod.CtrlCmd | KeyCode.KeyQ] },
+				win: { primary: KeyMod.Alt | KeyCode.F4, secondary: [KeyMod.CtrlCmd | KeyCode.KeyQ] }
 			},
 			menu: {
 				id: MenuId.MenubarFileMenu,
diff --git a/src/vs/workbench/electron-sandbox/parts/dialogs/dialogHandler.ts b/src/vs/workbench/electron-sandbox/parts/dialogs/dialogHandler.ts
index f2cc82ab8c5..d70413044be 100644
--- a/src/vs/workbench/electron-sandbox/parts/dialogs/dialogHandler.ts
+++ b/src/vs/workbench/electron-sandbox/parts/dialogs/dialogHandler.ts
@@ -86,7 +86,7 @@ export class NativeDialogHandler extends AbstractDialogHandler {
 				this.productService.commit || 'Unknown',
 				this.productService.date ? `${this.productService.date}${useAgo ? ' (' + fromNow(new Date(this.productService.date), true) + ')' : ''}` : 'Unknown',
 				process.versions['electron'],
-				process.versions['microsoft-build'],
+				'e2dac66',
 				process.versions['chrome'],
 				process.versions['node'],
 				process.versions['v8'],
